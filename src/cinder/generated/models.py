# generated by datamodel-codegen:
#   filename:  openapi.json
#   timestamp: 2026-01-26T17:24:06+00:00

from __future__ import annotations

from enum import Enum
from typing import Any, Literal
from uuid import UUID

from pydantic import (
    UUID4,
    AwareDatetime,
    BaseModel,
    ConfigDict,
    Field,
    RootModel,
    confloat,
    conint,
    constr,
)


class ReportSchema(BaseModel):
    job_id: str = Field(..., title='Job Id')
    id: int | None = Field(None, title='ID')


class ErrorSchema(BaseModel):
    detail: list[dict[str, Any] | str] | str = Field(..., title='Detail')


class RelationshipApiSchema(BaseModel):
    source_id: str = Field(..., title='Source Id')
    source_type: str = Field(..., title='Source Type')
    target_id: str = Field(..., title='Target Id')
    target_type: str = Field(..., title='Target Type')
    relationship_type: str = Field(..., title='Relationship Type')


class Score(BaseModel):
    score: confloat(ge=0.0, le=1.0) = Field(..., title='Score')
    inference_id: str | None = Field(None, title='Inference Id')


class AppliedPolicySchema(BaseModel):
    uuid: str = Field(..., title='Uuid')
    parent_uuid: str | None = Field(None, title='Parent Uuid')
    enforcement_actions: list[str] = Field(..., title='Enforcement Actions')
    name: constr(max_length=1000) = Field(..., title='Name')
    is_illegal: bool | None = Field(False, title='Is Illegal')


class EnforcementActionSchema(BaseModel):
    name: constr(max_length=100) = Field(..., title='Name')
    slug: constr(max_length=100) = Field(
        ...,
        description='This is the string that will be sent back to the client via webhook, which will denote what type of action they should take.',
        title='Slug',
    )
    description: str | None = Field(None, title='Description')


class EnforcementActionUpdateStrategy(Enum):
    append = 'append'
    set = 'set'


class EntityFilter(BaseModel):
    created_at__lt: AwareDatetime | None = Field(None, title='Created At  Lt')
    created_at__gt: AwareDatetime | None = Field(None, title='Created At  Gt')


class InputV1(BaseModel):
    limit: conint(ge=1) | None = Field(100, title='Limit')
    offset: conint(ge=0) | None = Field(0, title='Offset')


class DeleteEntityResponse(BaseModel):
    success: Literal[True] = Field(..., title='Success')
    message: str | None = Field(None, title='Message')
    deletions: dict[str, int] = Field(..., deprecated=True, title='Deletions')


class RelationshipDirectionV1(Enum):
    incoming = 'incoming'
    outgoing = 'outgoing'


class EntityNoteApiSchema(BaseModel):
    created_by: str | None = Field(..., title='Created By')
    content: str = Field(..., title='Content')


class CreateEntityNoteApiSchema(BaseModel):
    created_by: str | None = Field(..., title='Created By')
    content: str = Field(..., title='Content')
    is_url_safe_base64: bool | None = Field(False, title='Is Url Safe Base64')


class AttributeSchemaResponse(BaseModel):
    slug: str = Field(
        ..., description='The slug that identifies the schema', title='Slug'
    )
    label: str = Field(
        ...,
        description='The human-readable name of the schema, e.g. "Image"',
        title='Label',
    )
    attribute_type: str = Field(
        ..., description='The type of the attribute', title='Attribute Type'
    )
    attribute_sub_type: str | None = Field(
        None,
        description='The sub-type of the attribute, e.g. a list of strings',
        title='Attribute Sub Type',
    )


class EntitySchemaResponse(BaseModel):
    attribute_schemas: list[AttributeSchemaResponse] = Field(
        ..., title='Attribute Schemas'
    )
    title_attribute: AttributeSchemaResponse | None
    slug: str = Field(
        ..., description='The slug that identifies the schema', title='Slug'
    )
    label: str = Field(
        ...,
        description='The human-readable name of the schema, e.g. "Image"',
        title='Label',
    )


class RelationshipPairsSchemaResponse(BaseModel):
    source_slug: str = Field(..., title='Source Slug')
    target_slug: str = Field(..., title='Target Slug')


class RelationshipSchemaResponse(BaseModel):
    entity_pairs_by_slug: list[RelationshipPairsSchemaResponse] = Field(
        ..., title='Entity Pairs By Slug'
    )
    slug: str = Field(
        ..., description='The slug that identifies the schema', title='Slug'
    )
    label: str = Field(
        ...,
        description='The human-readable name of the schema, e.g. "Image"',
        title='Label',
    )
    reverse_label: str | None = Field(
        None,
        description="The human-readable name of the reverse relationship type (from target to source), e.g. 'Owned by'",
        title='Reverse Label',
    )


class SchemaResponse(BaseModel):
    entity_schemas: list[EntitySchemaResponse] = Field(..., title='Entity Schemas')
    relationship_schemas: list[RelationshipSchemaResponse] = Field(
        ..., title='Relationship Schemas'
    )


class EntitySchemaUpdateSchema(BaseModel):
    label: str = Field(
        ...,
        description='The human-readable name of the schema, e.g. "Image"',
        title='Label',
    )


class RelationshipSchemaUpdateSchema(BaseModel):
    label: str = Field(
        ...,
        description='The human-readable name of the schema, e.g. "Image"',
        title='Label',
    )
    reverse_label: str | None = Field(
        None,
        description="The human-readable name of the reverse relationship type (from target to source), e.g. 'Owned by'",
        title='Reverse Label',
    )


class EntitySchemaCreateSchema(BaseModel):
    slug: str = Field(
        ..., description='The slug that identifies the schema', title='Slug'
    )
    label: str = Field(
        ...,
        description='The human-readable name of the schema, e.g. "Image"',
        title='Label',
    )


class AttributeSchemaCreateSchema(BaseModel):
    slug: str = Field(
        ..., description='The slug that identifies the schema', title='Slug'
    )
    label: str = Field(
        ...,
        description='The human-readable name of the schema, e.g. "Image"',
        title='Label',
    )
    attribute_type: str = Field(
        ..., description='The type of the attribute', title='Attribute Type'
    )
    attribute_sub_type: str | None = Field(
        None,
        description='The sub-type of the attribute, e.g. a list of strings',
        title='Attribute Sub Type',
    )


class AttributeSchemaUpdateSchema(BaseModel):
    label: str = Field(
        ...,
        description='The human-readable name of the schema, e.g. "Image"',
        title='Label',
    )


class RelationshipSchemaCreateSchema(BaseModel):
    slug: str = Field(
        ..., description='The slug that identifies the schema', title='Slug'
    )
    label: str = Field(
        ...,
        description='The human-readable name of the schema, e.g. "Image"',
        title='Label',
    )
    reverse_label: str | None = Field(
        None,
        description="The human-readable name of the reverse relationship type (from target to source), e.g. 'Owned by'",
        title='Reverse Label',
    )


class AddSourceOrTargetEntitySchema(BaseModel):
    entity_schema_slug: str = Field(..., title='Entity Schema Slug')


class StatusSchema(BaseModel):
    id: int = Field(..., title='Id')
    name: str = Field(..., title='Name')


class TagSchema(BaseModel):
    name: constr(max_length=100) = Field(..., title='Name')
    description: str | None = Field(
        None,
        description='Optional description of what this tag represents',
        title='Description',
    )


class UserSchema(BaseModel):
    id: int | None = Field(None, title='ID')
    email: constr(max_length=254) = Field(..., title='Email Address')


class PolicyCreateSchema(BaseModel):
    public_name: str | None = Field(None, title='Public Name')
    enforcement_actions: list[str] | None = Field(None, title='Enforcement Actions')
    parent_external_id: UUID | None = Field(None, title='Parent External Id')
    status: str | None = Field(None, title='Status')
    name: constr(max_length=1000) = Field(..., title='Name')
    description: str = Field(..., title='Description')
    is_illegal: bool | None = Field(False, title='Is Illegal')
    is_non_violating: bool | None = Field(False, title='Is Non Violating')


class OptionalPolicyCreateSchema(BaseModel):
    public_name: str | None = Field(None, title='Public Name')
    enforcement_actions: list[str] | None = Field(None, title='Enforcement Actions')
    parent_external_id: UUID | None = Field(None, title='Parent External Id')
    status: str | None = Field(None, title='Status')
    name: str | None = Field(None, title='Name')
    description: str | None = Field(None, title='Description')
    is_illegal: bool | None = Field(None, title='Is Illegal')
    is_non_violating: bool | None = Field(None, title='Is Non Violating')


class EnforcementActionCreateSchema(BaseModel):
    slug: constr(max_length=100) = Field(
        ...,
        description='This is the string that will be sent back to the client via webhook, which will denote what type of action they should take.',
        title='Slug',
    )
    name: constr(max_length=100) = Field(..., title='Name')
    description: str | None = Field(None, title='Description')


class EnforcementActionUpdateSchema(BaseModel):
    name: constr(max_length=100) = Field(..., title='Name')
    description: str | None = Field(None, title='Description')


class CreateDecisionOnJobResponseSchema(BaseModel):
    entity_slug: str = Field(..., title='Entity Slug')
    entity_id: str = Field(..., title='Entity Id')
    uuid: str = Field(..., title='Uuid')
    applied_policies: list[AppliedPolicySchema] | None = Field(
        default_factory=list, title='Applied Policies'
    )
    enforcement_actions: list[EnforcementActionSchema] | None = Field(
        default_factory=list, title='Enforcement Actions'
    )
    typed_metadata: dict[str, Any] | None = Field(None, title='Typed Metadata')
    job_id: str = Field(..., title='Job Id')


class CreateDecisionBaseSchema(BaseModel):
    reasoning: str | None = Field(None, title='Reasoning')
    policy_uuids: list[str] | None = Field(None, title='Policy Uuids')
    enforcement_actions_slugs: list[str] | None = Field(
        None, title='Enforcement Actions Slugs'
    )
    enforcement_actions_update_strategy: EnforcementActionUpdateStrategy | None = None
    metadata: dict[str, Any] | None = Field(None, deprecated=True, title='Metadata')


class JobSchema(BaseModel):
    external_id: UUID | None = Field(None, title='External Id')


class JobUpdateSchema(BaseModel):
    priority: int | float = Field(..., title='Priority')


class JobCancelSchema(BaseModel):
    notes: str | None = Field(None, title='Notes')


class JobCategory(Enum):
    standard = 'standard'
    appeal = 'appeal'
    qa = 'qa'
    qa_gtg = 'qa_gtg'
    qa_admin_gtg = 'qa_admin_gtg'
    golden = 'golden'
    training = 'training'
    multi_review = 'multi_review'


class FormSubmissionSchema(BaseModel):
    id: str = Field(..., title='Id')
    value: dict[str, Any] = Field(
        ..., description='The value that was submitted through the form.', title='Value'
    )


class PolicyApplicationPolicySchema(BaseModel):
    uuid: str = Field(..., title='Uuid')
    name: str = Field(..., title='Name')
    is_illegal: bool = Field(..., title='Is Illegal')
    parent_uuid: str | None = Field(None, title='Parent Uuid')
    enforcement_actions: list[str] = Field(..., title='Enforcement Actions')


class AppealResponseSchema(BaseModel):
    external_id: UUID | None = Field(..., deprecated=True, title='External Id')
    job_external_id: UUID | None = Field(None, title='Job External Id')
    appeal_decision_external_id: UUID | None = Field(
        None, title='Appeal Decision External Id'
    )


class AppealSourceV1(Enum):
    unknown = 'unknown'
    reporter = 'reporter'
    subject = 'subject'


class CreateAppealSchema(BaseModel):
    queue_slug: str = Field(..., title='Queue Slug')
    decision_to_appeal_id: UUID = Field(..., title='Decision To Appeal Id')
    appealer_entity_type: str | None = Field(None, title='Appealer Entity Type')
    appealer_entity: dict[str, Any] | None = Field(None, title='Appealer Entity')
    appeal_source: AppealSourceV1 | None = 'unknown'
    reasoning: str | None = Field(None, title='Reasoning')
    priority: int | None = Field(None, title='Priority')
    assign_to_original_decision_maker: bool | None = Field(
        None, title='Assign To Original Decision Maker'
    )


class StatusOkResponse(BaseModel):
    status: Literal['ok'] = Field('ok', title='Status')


class EventRelationship(BaseModel):
    model_config = ConfigDict(
        extra='forbid',
    )
    source_id: str = Field(..., title='Source Id')
    source_entity_schema: str = Field(..., title='Source Entity Schema')
    target_id: str = Field(..., title='Target Id')
    target_entity_schema: str = Field(..., title='Target Entity Schema')
    relationship_schema: str = Field(..., title='Relationship Schema')


class ExternalClassifierScore(BaseModel):
    score: float = Field(..., title='Score')


class Classifier(BaseModel):
    slug: str = Field(..., title='Slug')


class EntityMinimalAttributes(BaseModel):
    id: str = Field(..., title='Id')


class Policy(BaseModel):
    id: UUID = Field(..., title='Id')
    name: str = Field(..., title='Name')


class Queue(BaseModel):
    slug: str = Field(..., title='Slug')


class Severity(BaseModel):
    id: int = Field(..., title='Id')
    value: int = Field(..., title='Value')
    name: str = Field(..., title='Name')
    enforcement_duration: int = Field(..., title='Enforcement Duration')


class Confidence(Enum):
    HIGH = 'HIGH'
    MEDIUM = 'MEDIUM'
    LOW = 'LOW'


class RelationshipDirection(Enum):
    incoming = 'incoming'
    outgoing = 'outgoing'


class Input(BaseModel):
    limit: conint(ge=1, le=1000) | None = Field(100, title='Limit')
    offset: conint(ge=0) | None = Field(0, title='Offset')


class PagedQueue(BaseModel):
    items: list[Queue] = Field(..., title='Items')
    count: int = Field(..., title='Count')


class QueueDetails(BaseModel):
    name: str = Field(..., title='Name')
    slug: str = Field(..., title='Slug')
    description: str = Field(..., title='Description')


class QueueType(Enum):
    standard = 'standard'
    training = 'training'


class CreateQueueSchema(BaseModel):
    name: str = Field(..., title='Name')
    slug: str = Field(..., title='Slug')
    queue_type: QueueType = Field(..., title='Queue Type')
    description: str | None = Field(None, title='Description')


class JobStatus(Enum):
    open = 'open'
    assigned = 'assigned'
    partially_answered = 'partially_answered'
    closed = 'closed'
    cancelled = 'cancelled'


class SuccessSchema(BaseModel):
    success: Literal[True] = Field(..., title='Success')
    message: str | None = Field(None, title='Message')


class MoveJobsToQueueSchema(BaseModel):
    job_ids: list[UUID] = Field(..., title='Job Ids')
    queue_slug: str = Field(..., title='Queue Slug')


class ReportFilterSchema(BaseModel):
    queue: str | None = Field(
        None, description="The slug of the job's queue", title='Queue'
    )
    status: JobStatus | None = Field(None, description='The status of the job')
    entity_schema: str | None = Field(
        None,
        description="The entity schema slug of the report's entity",
        title='Entity Schema',
    )
    entity_id: str | None = Field(
        None, description="The ID of the report's entity", title='Entity Id'
    )
    job_id: UUID | None = Field(None, description='The ID of the job', title='Job Id')


class AppealFilterSchema(BaseModel):
    decision_id: str | None = Field(
        None, description='The ID of the appealed decision', title='Decision Id'
    )
    resolved_by_decision_id: str | None = Field(
        None,
        description='The ID of the replacement decision',
        title='Resolved By Decision Id',
    )
    is_resolved: bool | None = Field(
        None, description='Whether the appeal has been resolved', title='Is Resolved'
    )
    queue: str | None = Field(None, description='The slug of the queue', title='Queue')


class MinimalDecision(BaseModel):
    id: UUID = Field(..., title='Id')
    created_at: AwareDatetime = Field(..., title='Created At')


class AppealOutcome(Enum):
    adjustment = 'adjustment'
    accepted = 'accepted'
    denied = 'denied'


class AppealSource(Enum):
    unknown = 'unknown'
    reporter = 'reporter'
    subject = 'subject'


class KeywordStore(BaseModel):
    slug: str = Field(..., title='Slug')


class PagedKeywordStore(BaseModel):
    items: list[KeywordStore] = Field(..., title='Items')
    count: int = Field(..., title='Count')


class KeywordType(Enum):
    PLAIN_TEXT = 'PLAIN_TEXT'
    REGEX = 'REGEX'
    URL = 'URL'


class UrlComponentType(Enum):
    DOMAIN = 'DOMAIN'
    PATH = 'PATH'
    EXACT = 'EXACT'


class SecurityEventName(Enum):
    audit_user_login_attempted = 'audit.user_login_attempted'
    audit_group_created = 'audit.group_created'
    audit_group_updated = 'audit.group_updated'
    audit_group_deleted = 'audit.group_deleted'
    audit_group_permission_changed = 'audit.group_permission_changed'
    audit_group_member_added = 'audit.group_member_added'
    audit_group_user_removed = 'audit.group_user_removed'


class AuditLogSchema(BaseModel):
    id: UUID = Field(..., title='Id')
    ts_event: AwareDatetime = Field(..., title='Ts Event')
    ts_ingestion: AwareDatetime = Field(..., title='Ts Ingestion')
    entity_schema: str | None = Field(..., title='Entity Schema')
    entity_id: str | None = Field(..., title='Entity Id')
    event_name: str = Field(..., title='Event Name')
    source: str = Field(..., title='Source')
    payload: dict[str, Any] = Field(..., title='Payload')


class PagedAuditLogSchema(BaseModel):
    items: list[AuditLogSchema] = Field(..., title='Items')
    count: int = Field(..., title='Count')


class AcceptedDecisionResolutionType(Enum):
    escalation = 'escalation'
    agreement = 'agreement'


class DecisionCreatedPolicy(BaseModel):
    id: str = Field(..., title='Id')
    name: str = Field(..., title='Name')
    is_illegal: bool = Field(..., title='Is Illegal')
    enforcement_actions: list[str] = Field(..., title='Enforcement Actions')
    parent_id: str | None = Field(None, title='Parent Id')
    is_non_violating: bool = Field(..., title='Is Non Violating')


class DecisionRecordType(Enum):
    queue_review = 'queue_review'
    manual = 'manual'
    manual_override = 'manual_override'
    investigate_review = 'investigate_review'
    bulk_action = 'bulk_action'
    api_decision = 'api_decision'
    automated = 'automated'
    cinder_workflow = 'cinder_workflow'
    override = 'override'
    revert = 'revert'
    confirm = 'confirm'
    qa = 'qa'
    escalate = 'escalate'
    change_queue = 'change_queue'
    returned = 'returned'
    cancel = 'cancel'
    skip = 'skip'
    defer = 'defer'


class SourceQueue(BaseModel):
    slug: str = Field(..., title='Slug')
    is_multi_review: bool = Field(..., title='Is Multi Review')


class WebhookPrediction(BaseModel):
    inference_id: str | None = Field(None, title='Inference Id')
    attributes: list[str] = Field(..., title='Attributes')
    policy_id: str | None = Field(None, title='Policy Id')
    confidence: Confidence | None = None
    is_positive: bool = Field(..., title='Is Positive')


class WebhookUserGroup(BaseModel):
    name: str = Field(..., title='Name')


class WorkflowEventName(Enum):
    CALL_DEPTH_EXCEEDED = 'CALL_DEPTH_EXCEEDED'
    CLOSE_RELATED_JOBS = 'CLOSE_RELATED_JOBS'
    CREATE_DECISION = 'CREATE_DECISION'
    SEND_TO_QUEUE = 'SEND_TO_QUEUE'
    SEND_COMMUNICATION = 'SEND_COMMUNICATION'
    CREATE_NCMEC_REPORT = 'CREATE_NCMEC_REPORT'
    CHAIN_WORKFLOW = 'CHAIN_WORKFLOW'
    CHANGE_PRIORITY = 'CHANGE_PRIORITY'
    MOVE_JOB = 'MOVE_JOB'


class WorkflowRule(BaseModel):
    id: UUID4 = Field(..., title='Id')
    name: str | None = Field(None, title='Name')


class WorkflowTrigger(Enum):
    DECISION_CREATED = 'DECISION_CREATED'
    ENTITY_CREATED_OR_UPDATED = 'ENTITY_CREATED_OR_UPDATED'
    POINT_ASSIGNMENT_CROSSES_THRESHOLD_UP = 'POINT_ASSIGNMENT_CROSSES_THRESHOLD_UP'
    POINT_ASSIGNMENT_CROSSES_THRESHOLD_DOWN = 'POINT_ASSIGNMENT_CROSSES_THRESHOLD_DOWN'
    REPORT_CREATED = 'REPORT_CREATED'
    APPEAL_CREATED = 'APPEAL_CREATED'
    EXECUTE_SYNC_WORKFLOW = 'EXECUTE_SYNC_WORKFLOW'
    BY_WORKFLOW = 'BY_WORKFLOW'


class IncidentType(Enum):
    Child_Pornography__possession__manufacture__and_distribution_ = (
        'Child Pornography (possession, manufacture, and distribution)'
    )
    Child_Sex_Trafficking = 'Child Sex Trafficking'
    Child_Sex_Tourism = 'Child Sex Tourism'
    Child_Sexual_Molestation = 'Child Sexual Molestation'
    Misleading_Domain_Name = 'Misleading Domain Name'
    Misleading_Words_or_Digital_Images_on_the_Internet = (
        'Misleading Words or Digital Images on the Internet'
    )
    Online_Enticement_of_Children_for_Sexual_Acts = (
        'Online Enticement of Children for Sexual Acts'
    )
    Unsolicited_Obscene_Material_Sent_to_a_Child = (
        'Unsolicited Obscene Material Sent to a Child'
    )


class EntityRefreshEntity(BaseModel):
    entity_schema: str = Field(..., title='Entity Schema')
    entity_id: str = Field(..., title='Entity Id')
    updated_at: AwareDatetime | None = Field(None, title='Updated At')


class JobActionSource(Enum):
    auto = 'auto'
    workflow = 'workflow'
    api = 'api'
    manual = 'manual'


class JobActionType(Enum):
    made_decision = 'made_decision'
    skipped = 'skipped'
    changed_queue = 'changed_queue'
    escalated = 'escalated'
    returned = 'returned'
    deferred = 'deferred'
    cancelled = 'cancelled'


class DecisionReviewContext(Enum):
    multi_review = 'multi_review'
    appeal_review = 'appeal_review'
    golden_review = 'golden_review'
    override = 'override'
    qa = 'qa'
    backtest = 'backtest'


class CreateDataFailureWebhook(BaseModel):
    error: str = Field(..., title='Error')
    request_body: Any = Field(..., title='Request Body')


class EntityRefreshWebhook(BaseModel):
    timestamp: AwareDatetime = Field(..., title='Timestamp')
    entities: list[EntityRefreshEntity] = Field(..., title='Entities')


class ClassifierScoreApiSchema(BaseModel):
    attributes: list[str] = Field(..., min_length=1, title='Attributes')
    groups: dict[str, dict[str, Score]] = Field(..., title='Groups')


class EntityApiSchema(BaseModel):
    entity_type: str = Field(..., title='Entity Type')
    attributes: dict[str, Any] = Field(..., title='Attributes')
    classifier_scores: list[ClassifierScoreApiSchema] | None = Field(
        None, title='Classifier Scores'
    )


class CreateDecisionResponseSchema(BaseModel):
    entity_slug: str = Field(..., title='Entity Slug')
    entity_id: str = Field(..., title='Entity Id')
    uuid: str = Field(..., title='Uuid')
    applied_policies: list[AppliedPolicySchema] | None = Field(
        default_factory=list, title='Applied Policies'
    )
    enforcement_actions: list[EnforcementActionSchema] | None = Field(
        default_factory=list, title='Enforcement Actions'
    )
    typed_metadata: dict[str, Any] | None = Field(None, title='Typed Metadata')


class CreateDecisionSchema(BaseModel):
    reasoning: str | None = Field(None, title='Reasoning')
    policy_uuids: list[str] | None = Field(None, title='Policy Uuids')
    enforcement_actions_slugs: list[str] | None = Field(
        None, title='Enforcement Actions Slugs'
    )
    enforcement_actions_update_strategy: EnforcementActionUpdateStrategy | None = None
    metadata: dict[str, Any] | None = Field(None, deprecated=True, title='Metadata')
    entity_type: str = Field(..., title='Entity Type')
    entity: dict[str, Any] = Field(..., title='Entity')


class PagedEntityApiSchema(BaseModel):
    items: list[EntityApiSchema] = Field(..., title='Items')
    total: int = Field(..., title='Total')


class DeletionCascadeConfig(BaseModel):
    relationship_schema: str = Field(..., title='Relationship Schema')
    direction: RelationshipDirectionV1
    related_entity_schema: str = Field(..., title='Related Entity Schema')


class DeletionConfig(BaseModel):
    cascades: list[DeletionCascadeConfig] | None = Field(None, title='Cascades')
    is_url_safe_base64: bool | None = Field(False, title='Is Url Safe Base64')


class CreateEntitiesAndRelationshipsResponseSchema(BaseModel):
    success: Literal[True] = Field(..., title='Success')
    message: str | None = Field(None, title='Message')
    entities: list[EntityApiSchema] | None = Field(None, title='Entities')
    relationships: list[RelationshipApiSchema] | None = Field(
        None, title='Relationships'
    )


class PolicySchema(BaseModel):
    last_updated_by: UserSchema | None = None
    created_by: UserSchema | None = None
    status: StatusSchema
    uuid: str = Field(..., title='Uuid')
    parent: str | None = Field(..., title='Parent')
    description: str = Field(
        ...,
        description='The main text of the policy, in Markdown format.',
        title='Description',
    )
    nested_policies: list[PolicySchema] | None = Field(
        default_factory=list, title='Nested Policies'
    )
    labels: list[TagSchema] | None = Field(default_factory=list, title='Labels')
    tags: list[TagSchema] | None = Field(default_factory=list, title='Tags')
    enforcement_actions: list[EnforcementActionSchema] = Field(
        ..., title='Enforcement Actions'
    )
    public_name: str = Field(..., title='Public Name')
    name: constr(max_length=1000) = Field(..., title='Name')
    created_at: AwareDatetime = Field(..., title='Created At')
    updated_at: AwareDatetime = Field(..., title='Updated At')
    is_illegal: bool | None = Field(False, title='Is Illegal')
    is_non_violating: bool | None = Field(False, title='Is Non Violating')


class DecisionFilter(BaseModel):
    created_at__lt: AwareDatetime | None = Field(None, title='Created At  Lt')
    created_at__gt: AwareDatetime | None = Field(None, title='Created At  Gt')
    job_category: JobCategory | None = None
    queue: str | None = Field(
        None, description='The slug of a queue to get decisions for.', title='Queue'
    )
    entity_schema: str | None = Field(
        None,
        description='The schema of the entity to get decisions for.',
        title='Entity Schema',
    )
    entity_id: str | None = Field(
        None,
        description='The ID of the entity to get decisions for.',
        title='Entity Id',
    )


class DecisionSchema(BaseModel):
    user: str | None = Field(None, title='User')
    queue_slug: str | None = Field(None, title='Queue Slug')
    job_id: str | None = Field(None, title='Job Id')
    uuid: str = Field(..., title='Uuid')
    applied_policies: list[PolicyApplicationPolicySchema] | None = Field(
        None, title='Applied Policies'
    )
    applied_actions: list[str] | None = Field(
        None,
        description='Any enforcement actions applied via this decision. Inludes enforcement actions from applied policies as well as any manually added enforcement actions.',
        title='Applied Actions',
    )
    entity: EntityApiSchema
    entity_slug: str | None = Field(None, title='Entity Slug')
    entity_id: str | None = Field(None, title='Entity Id')
    handle_time_seconds: int | None = Field(None, title='Handle Time Seconds')
    resolution_time_seconds: int | None = Field(None, title='Resolution Time Seconds')
    notes: str = Field(..., title='Notes')
    is_training: bool = Field(..., title='Is Training')
    previous_decision_id: str | None = Field(None, title='Previous Decision Id')
    next_decision_id: str | None = Field(None, title='Next Decision Id')
    form_submissions: list[FormSubmissionSchema] | None = Field(
        None, title='Form Submissions'
    )
    created_at: AwareDatetime = Field(..., title='Created At')
    decision_type: str = Field(..., title='Decision Type')
    job_assigned_at: AwareDatetime | None = Field(None, title='Job Assigned At')
    typed_metadata: dict[str, Any] | None = Field(None, title='Typed Metadata')


class PagedDecisionSchema(BaseModel):
    items: list[DecisionSchema] = Field(..., title='Items')
    count: int = Field(..., title='Count')


class AppealErrorSchema(BaseModel):
    detail: list[dict[str, Any] | str] | str = Field(..., title='Detail')
    latest_decision: DecisionSchema


class ExternalClassifierGroup(RootModel[dict[str, ExternalClassifierScore]]):
    root: dict[str, ExternalClassifierScore]


class ExternalClassifierScoreItem(BaseModel):
    attributes: list[str] = Field(..., title='Attributes')
    groups: dict[str, ExternalClassifierGroup] = Field(..., title='Groups')


class ActionFanOut(BaseModel):
    model_config = ConfigDict(
        extra='forbid',
    )
    entity_schema: str = Field(..., title='Entity Schema')
    relationship_schema: str = Field(..., title='Relationship Schema')
    direction: RelationshipDirection


class Entity(BaseModel):
    entity_schema: str = Field(..., title='Entity Schema')
    attributes: EntityMinimalAttributes = Field(
        ..., description="The entity's attributes. Only contains the ID."
    )


class Prediction(BaseModel):
    classifier: Classifier
    entity: Entity
    policy: Policy
    is_positive: bool = Field(..., title='Is Positive')
    confidence: Confidence | None


class ApplyPointsApiResponse(BaseModel):
    type: Literal['apply_points'] = Field('apply_points', title='Type')
    entity: Entity
    fan_out: ActionFanOut | None
    points: int = Field(..., title='Points')


class CloseRelatedJobsApiResponse(BaseModel):
    type: Literal['close_related_jobs'] = Field('close_related_jobs', title='Type')
    entity: Entity
    fan_out: ActionFanOut | None
    queue_slugs: list[str] = Field(..., title='Queue Slugs')
    tags: list[str] = Field(..., title='Tags')


class CreateDecisionApiResponse(BaseModel):
    type: Literal['create_decision'] = Field('create_decision', title='Type')
    entity: Entity
    fan_out: ActionFanOut | None
    policies: list[Policy] = Field(..., title='Policies')
    actions: list[str] = Field(..., title='Actions')
    point_assignments: list[Severity] = Field(..., title='Point Assignments')


class CreatePredictionsApiResponse(BaseModel):
    type: Literal['create_predictions'] = Field('create_predictions', title='Type')
    classifier_group: str = Field(..., title='Classifier Group')
    predictions: list[Prediction] = Field(..., title='Predictions')


class CreateReportApiResponse(BaseModel):
    type: Literal['create_report'] = Field('create_report', title='Type')
    reported_entity: Entity
    reporter: Entity | None
    reasoning: str | None = Field(..., title='Reasoning')
    report_metadata: dict[str, Any] | None = Field(..., title='Report Metadata')
    reported_attribute_slugs: list[str] = Field(..., title='Reported Attribute Slugs')


class EnrichEntityApiResponse(BaseModel):
    type: Literal['enrich_entity'] = Field('enrich_entity', title='Type')
    entity: Entity
    enriched_attributes: dict[
        str,
        str
        | int
        | float
        | bool
        | list[str]
        | list[int]
        | list[float]
        | list[bool]
        | dict[str, Any],
    ] = Field(..., title='Enriched Attributes')


class SendToQueueApiResponse(BaseModel):
    type: Literal['send_to_queue'] = Field('send_to_queue', title='Type')
    entity: Entity
    fan_out: ActionFanOut | None
    queue: Queue
    reason: str = Field(..., title='Reason')
    priority: int | None = Field(None, title='Priority')


class SendUserCommunicationApiResponse(BaseModel):
    type: Literal['send_user_communication'] = Field(
        'send_user_communication', title='Type'
    )
    entity: Entity
    fan_out: ActionFanOut | None
    subject: str | None = Field(..., title='Subject')
    message: str = Field(..., title='Message')


class JobFilterSchema(BaseModel):
    queue: str | None = Field(
        None, description="The slug of the job's queue", title='Queue'
    )
    status: JobStatus | None = None
    entity_schema: str | None = Field(
        None,
        description="The entity schema slug of the job's entity",
        title='Entity Schema',
    )
    entity_id: str | None = Field(
        None, description="The ID of the job's entity", title='Entity Id'
    )


class Job(BaseModel):
    id: UUID = Field(..., title='Id')
    entity: Entity
    status: JobStatus
    created_at: AwareDatetime = Field(..., title='Created At')
    queue: Queue | None


class PagedJob(BaseModel):
    items: list[Job] = Field(..., title='Items')
    count: int = Field(..., title='Count')


class Report(BaseModel):
    reasoning: str = Field(..., title='Reasoning')
    created_at: AwareDatetime = Field(..., title='Created At')
    metadata: dict[str, Any] | None = Field(..., title='Metadata')
    entity: Entity
    reporter: Entity | None
    attribute_slugs: list[str] | None = Field(..., title='Attribute Slugs')


class PagedReport(BaseModel):
    items: list[Report] = Field(..., title='Items')
    count: int = Field(..., title='Count')


class Appeal(BaseModel):
    appealer: Entity | None
    appealer_reasoning: str = Field(..., title='Appealer Reasoning')
    appealed_decision: MinimalDecision | None
    resolved_by_decision: MinimalDecision | None
    source: AppealSource
    outcome: AppealOutcome | None
    created_at: AwareDatetime = Field(..., title='Created At')


class PagedAppeal(BaseModel):
    items: list[Appeal] = Field(..., title='Items')
    count: int = Field(..., title='Count')


class Keyword(BaseModel):
    type: KeywordType
    value: str = Field(..., title='Value')
    url_type: UrlComponentType | None = None


class PagedKeyword(BaseModel):
    items: list[Keyword] = Field(..., title='Items')
    count: int = Field(..., title='Count')


class AuditLogFilterSchema(BaseModel):
    start_date: AwareDatetime | None = Field(None, title='Start Date')
    end_date: AwareDatetime | None = Field(None, title='End Date')
    events: list[SecurityEventName] | None = Field(None, title='Events')
    sources: list[str] | None = Field(None, title='Sources')
    entity_schemas: list[str] | None = Field(None, title='Entity Schemas')
    entity_ids: list[str] | None = Field(None, title='Entity Ids')


class WebhookEntity(BaseModel):
    entity_schema: str = Field(..., title='Entity Schema')
    attributes: dict[str, Any] = Field(..., title='Attributes')
    predictions: list[WebhookPrediction] | None = Field(None, title='Predictions')


class WebhookUser(BaseModel):
    name: str = Field(..., title='Name')
    email: str = Field(..., title='Email')
    groups: list[WebhookUserGroup] = Field(..., title='Groups')


class NcmecReportWebhook(BaseModel):
    entities: list[WebhookEntity] = Field(..., title='Entities')
    incident_type: IncidentType
    incident_timestamp: AwareDatetime = Field(..., title='Incident Timestamp')
    report_id: int = Field(..., title='Report Id')
    user: WebhookUser | None = None


class CreateEntitiesAndRelationshipsSchema(BaseModel):
    entities: list[EntityApiSchema] | None = Field(None, title='Entities')
    relationships: list[RelationshipApiSchema] | None = Field(
        None, title='Relationships'
    )


class CreateReportSchema(BaseModel):
    queue_slug: str = Field(..., title='Queue Slug')
    entity_type: str = Field(..., title='Entity Type')
    entity: dict[str, Any] = Field(..., title='Entity')
    reasoning: str | None = Field(None, title='Reasoning')
    report_metadata: dict[str, Any] | None = Field(None, title='Report Metadata')
    reporter: dict[str, Any] | None = Field(
        None,
        description='The User entity who reported this content. This will add a `reporter_of` relationship between the reported entity and the reporter. The reporter will be included in the outgoing webhook when a decision is made.',
        title='Reporter',
    )
    classifier_scores: list[ClassifierScoreApiSchema] | None = Field(
        None, title='Classifier Scores'
    )
    context: CreateEntitiesAndRelationshipsSchema | None = None
    priority: int | None = Field(None, title='Priority')
    reported_attribute_slugs: list[str] | None = Field(
        None,
        description='List of attribute slugs that are being reported. These are used to highlight specific attributes of the reported entity that are relevant to the report.',
        title='Reported Attribute Slugs',
    )


class EventEntity(BaseModel):
    model_config = ConfigDict(
        extra='forbid',
    )
    entity_schema: str = Field(..., title='Entity Schema')
    attributes: dict[str, Any] = Field(..., title='Attributes')
    classifier_scores: list[ExternalClassifierScoreItem] | None = Field(
        None, title='Classifier Scores'
    )
    predictions: list[dict[str, Any]] | None = Field(None, title='Predictions')


class AddToContentBankApiResponse(BaseModel):
    type: Literal['add_to_content_bank'] = Field('add_to_content_bank', title='Type')
    entity: Entity
    content_bank_slug: str = Field(..., title='Content Bank Slug')
    keyword_value: str = Field(..., title='Keyword Value')
    description: str = Field(..., title='Description')


class WorkflowActionApiResponseUnion(
    RootModel[
        AddToContentBankApiResponse
        | ApplyPointsApiResponse
        | CreateDecisionApiResponse
        | CreatePredictionsApiResponse
        | CreateReportApiResponse
        | EnrichEntityApiResponse
        | SendToQueueApiResponse
        | CloseRelatedJobsApiResponse
        | SendUserCommunicationApiResponse
    ]
):
    root: (
        AddToContentBankApiResponse
        | ApplyPointsApiResponse
        | CreateDecisionApiResponse
        | CreatePredictionsApiResponse
        | CreateReportApiResponse
        | EnrichEntityApiResponse
        | SendToQueueApiResponse
        | CloseRelatedJobsApiResponse
        | SendUserCommunicationApiResponse
    ) = Field(..., discriminator='type', title='WorkflowActionApiResponseUnion')


class DecisionCreatedAppealResolution(BaseModel):
    appealer: WebhookEntity | None = None
    source: AppealSource
    outcome: AppealOutcome


class DecisionCreatedAppealedDecision(BaseModel):
    id: str = Field(..., title='Id')
    type: DecisionRecordType
    metadata: dict[str, Any] | None = Field(None, title='Metadata')
    user: WebhookUser | None = None
    policies: list[DecisionCreatedPolicy] = Field(..., title='Policies')
    policies_removed: list[DecisionCreatedPolicy] | None = Field(
        None, title='Policies Removed'
    )
    enforcement_actions: list[str] = Field(..., title='Enforcement Actions')
    enforcement_actions_removed: list[str] | None = Field(
        None, title='Enforcement Actions Removed'
    )
    notes: str | None = Field(None, title='Notes')
    appealed_decision: DecisionCreatedAppealedDecision | None = None


class DecisionCreatedDecision(BaseModel):
    id: str = Field(..., title='Id')
    type: DecisionRecordType
    metadata: dict[str, Any] | None = Field(None, title='Metadata')
    user: WebhookUser | None = None


class DecisionCreatedPointUpdate(BaseModel):
    points_change: int = Field(..., title='Points Change')
    points_total: int = Field(..., title='Points Total')
    entity: WebhookEntity


class DecisionCreatedPreviousDecision(BaseModel):
    id: str = Field(..., title='Id')
    type: DecisionRecordType
    metadata: dict[str, Any] | None = Field(None, title='Metadata')
    user: WebhookUser | None = None
    policies: list[DecisionCreatedPolicy] = Field(..., title='Policies')
    policies_removed: list[DecisionCreatedPolicy] | None = Field(
        None, title='Policies Removed'
    )
    enforcement_actions: list[str] = Field(..., title='Enforcement Actions')
    enforcement_actions_removed: list[str] | None = Field(
        None, title='Enforcement Actions Removed'
    )
    notes: str | None = Field(None, title='Notes')
    pervious_decision: DecisionCreatedPreviousDecision | None = None


class DecisionCreatedResolutionPathStep(BaseModel):
    user: WebhookUser | None = None
    notes: str | None = Field(None, title='Notes')
    metadata: dict[str, Any] | None = Field(None, title='Metadata')
    policies: list[DecisionCreatedPolicy] = Field(..., title='Policies')
    timestamp: AwareDatetime = Field(..., title='Timestamp')


class WorkflowEvent(BaseModel):
    event_name: WorkflowEventName
    call_depth: int | None = Field(None, title='Call Depth')
    entity: WebhookEntity | None = None
    decision: DecisionCreatedDecision | None = None
    report: Report | None = None


class UserCommunication(BaseModel):
    id: UUID4 = Field(..., title='Id')
    subject: str = Field(..., title='Subject')
    message: str = Field(..., title='Message')
    user: WebhookUser | None = None
    user_entity: WebhookEntity | None = None
    related_decision: DecisionCreatedDecision | None = None


class UserCommunicationCreatedWebhook(BaseModel):
    user_communication: UserCommunication
    timestamp: AwareDatetime = Field(..., title='Timestamp')


class CustomerEventEntitySubgraph(BaseModel):
    model_config = ConfigDict(
        extra='forbid',
    )
    entities: list[EventEntity] | None = Field(None, title='Entities')
    relationships: list[EventRelationship] | None = Field(None, title='Relationships')


class WorkflowResult(BaseModel):
    path: list[str] = Field(
        ..., description='The path of nodes taken through the workflow.', title='Path'
    )
    actions: list[WorkflowActionApiResponseUnion] = Field(
        ..., description='The actions taken by the workflow.', title='Actions'
    )


class ReportCreatedEvent(BaseModel):
    model_config = ConfigDict(
        extra='forbid',
    )
    entity: EventEntity = Field(
        ...,
        description='The entity being reported; includes entity_schema and attributes',
    )
    reporter: EventEntity | None = Field(
        None,
        description='The User entity who reported this content; includes entity_schema and attributes',
    )
    report_metadata: dict[str, Any] | None = Field(
        None,
        description='Additional metadata about the report',
        title='Report Metadata',
    )
    subgraph: CustomerEventEntitySubgraph | None = Field(
        None, description='Additional context entities and relationships'
    )
    reported_attribute_slugs: list[str] | None = Field(
        None,
        description='List of attribute slugs that are being reported. These are used to highlightspecific attributes of the reported entity that are relevant to the report.',
        title='Reported Attribute Slugs',
    )
    reasoning: str | None = Field(
        None,
        description='Human-readable explanation or reasoning/categorical understanding for why this report was created',
        title='Reasoning',
    )
    queue_slug: str | None = Field(
        None,
        description='Optional queue slug to create a job for this report. If provided, the report will be created with a job in the specified queue.',
        title='Queue Slug',
    )


class DecisionCreatedAppeal(BaseModel):
    appealed_decision: DecisionCreatedAppealedDecision


class DecisionCreatedResolution(BaseModel):
    resolution_type: AcceptedDecisionResolutionType
    resolution_path: list[DecisionCreatedResolutionPathStep] = Field(
        ..., title='Resolution Path'
    )


class Workflow(BaseModel):
    id: UUID4 = Field(..., title='Id')
    name: str = Field(..., title='Name')
    rule: WorkflowRule
    event: WorkflowEvent
    trigger_type: WorkflowTrigger


class JobActionMadeBy(BaseModel):
    user: WebhookUser | None = None
    workflow: Workflow | None = None


class JobActionedWebhook(BaseModel):
    job: Job
    source: JobActionSource
    action: JobActionType
    timestamp: AwareDatetime = Field(..., title='Timestamp')
    action_made_by: JobActionMadeBy
    notes: str | None = Field(None, title='Notes')


class CustomerEvent(BaseModel):
    model_config = ConfigDict(
        extra='forbid',
    )
    event_name: str = Field(..., title='Event Name')
    entity: EventEntity
    subgraph: CustomerEventEntitySubgraph | None = None


class DecisionCreatedSourceReport(BaseModel):
    reasoning: str | None = Field(None, title='Reasoning')
    metadata: dict[str, Any] | None = Field(None, title='Metadata')
    reporter: WebhookEntity | None = None
    workflow: Workflow | None = None


class DecisionCreatedSourceJob(BaseModel):
    id: str = Field(..., title='Id')
    created_at: AwareDatetime = Field(..., title='Created At')
    reports: list[DecisionCreatedSourceReport] = Field(..., title='Reports')
    queue: SourceQueue | None = None


class CreatedSource(BaseModel):
    decision: DecisionCreatedDecision | None = None
    user: WebhookUser | None = None
    workflow: Workflow | None = None
    job: DecisionCreatedSourceJob | None = None


class DecisionReviewedDecision(BaseModel):
    timestamp: AwareDatetime = Field(..., title='Timestamp')
    source: CreatedSource
    policies: list[DecisionCreatedPolicy] = Field(..., title='Policies')
    notes: str | None = Field(None, title='Notes')


class DecisionCreatedWebhook(BaseModel):
    entity: WebhookEntity
    enforcement_actions: list[str] = Field(..., title='Enforcement Actions')
    enforcement_actions_removed: list[str] | None = Field(
        None, title='Enforcement Actions Removed'
    )
    timestamp: AwareDatetime = Field(..., title='Timestamp')
    handle_time_ms: int | None = Field(None, title='Handle Time Ms')
    policies: list[DecisionCreatedPolicy] = Field(..., title='Policies')
    policies_removed: list[DecisionCreatedPolicy] | None = Field(
        None, title='Policies Removed'
    )
    point_updates: list[DecisionCreatedPointUpdate] | None = Field(
        None, title='Point Updates'
    )
    notes: str | None = Field(None, title='Notes')
    source: CreatedSource
    resolution: DecisionCreatedResolution | None = None
    appeals_resolved: list[DecisionCreatedAppealResolution] | None = Field(
        None, title='Appeals Resolved'
    )
    previous_decision: DecisionCreatedPreviousDecision | None = None
    appeal: DecisionCreatedAppeal | None = None


class ReportCreatedWebhook(BaseModel):
    report: Report
    source: CreatedSource


class DecisionReviewedWebhook(BaseModel):
    timestamp: AwareDatetime = Field(..., title='Timestamp')
    review_context: DecisionReviewContext
    entity: WebhookEntity
    decision_expected: DecisionReviewedDecision
    decision_reviewed: DecisionReviewedDecision
    correct_violating_class: bool | None = Field(..., title='Correct Violating Class')
    correct_policies: bool | None = Field(..., title='Correct Policies')
    alignment: float | None = Field(..., title='Alignment')
    was_correct: bool = Field(..., title='Was Correct')


PolicySchema.model_rebuild()
DecisionCreatedAppealedDecision.model_rebuild()
DecisionCreatedPreviousDecision.model_rebuild()
